<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="iconfont/iconfont.css">
    <link rel="stylesheet" href="css/header.css" />
    <script type="text/javascript" charset="utf-8">
      	mui.init();
//    	状态栏
      	mui.plusReady(function(){
      		plus.navigator.setStatusBarStyle("light");
      		plus.navigator.setStatusBarBackground("#007AFF");
      	});
    </script>
</head>
<body>
	<!--程序顶部标题-->
	<header class="mui-bar mui-bar-nav title">
	    <h1 class="mui-title title-color" id="headtitle">小溪</h1>
	</header>


	<!--底部bar栏-->
	<nav class="mui-bar mui-bar-tab">
	    <a class="mui-tab-item mui-active" tabindex="0">
	        <span class="mui-icon iconfont icon-iconfonticonfontxinxi"></span>
	        <span class="mui-tab-label">小溪</span>
	    </a>
	    <a class="mui-tab-item" tabindex="1">
	        <span class="mui-icon iconfont icon-tongxunlu" ></span>
	        <span class="mui-tab-label">通讯录</span>
	    </a>
	    <a class="mui-tab-item" tabindex="2">
	        <span class="mui-icon iconfont icon-faxian1" ></span>
	        <span class="mui-tab-label">发现</span>
	    </a>
	    <a class="mui-tab-item" tabindex="3">
	        <span class="mui-icon iconfont icon-htmal5icon02" ></span>
	        <span class="mui-tab-label">我</span>
	    </a>
	</nav>
	
	
	<script type="text/javascript" charset="utf-8">
      	var xiaoxiArray = [
	      	{
	      		pageId:"xiaoxi-chatlist.html",
	      		pageUrl:"xiaoxi-chatlist.html",
	      		title:"小溪"
	      	},
	      	{
	      		pageId:"xiaoxi-contact.html",
	      		pageUrl:"xiaoxi-contact.html",
	      		title:"通讯录"
	      	},
	      	{
	      		pageId:"xiaoxi-find.html",
	      		pageUrl:"xiaoxi-find.html",
	      		title:"发现"
	      	},
	      	{
	      		pageId:"xiaoxi-my.html",
	      		pageUrl:"xiaoxi-my.html",
	      		title:"我"
	      	}
      	];
      	
      	var xiaoxiStyle = {
      		top:"44px",
      		bottom:"50px"
      	}
      	
      	mui.plusReady(function() {
      		//禁止返回到登录注册页面
      		mui.back= function() {
      			return false;
      		}
      		
      		//对网络连接进行事件监听
      		
      		//获取当前的webview对象
      		var indexWebview = plus.webview.currentWebview();
      		
      		//向当前主页webview追加子页4张webview对象
      		for (var i=0;i<xiaoxiArray.length;i++) {
      			var xiaoxiPage = plus.webview.create(xiaoxiArray[i].pageUrl,xiaoxiArray[i].pageId,xiaoxiStyle);
      			//隐藏webview窗口
      			xiaoxiPage.hide();
      			//追加每个子页面到当前主页面
      			indexWebview.append(xiaoxiPage)
      		}
      		plus.webview.show(xiaoxiArray[0].pageId);
      		
      		//批量绑定tap事件,展示不同的页面
      		mui(".mui-bar-tab").on("tap","a",function() {
      			var tabindex = this.getAttribute("tabindex");
      			//显示点击的tab选项所对应的页面
      			plus.webview.show(xiaoxiArray[tabindex].pageId,"fade-in",200);
      			
      			//更改标题
      			var headtitle = document.getElementById("headtitle");
      			headtitle.innerHTML=xiaoxiArray[tabindex].title;
      			
      			for (var i=0;i<xiaoxiArray.length;i++) {
      				if(i != tabindex ) {
      					plus.webview.hide(xiaoxiArray[i].pageId,"fade-out",200);
      				}
      		 	}
      		});
      		
      		setTimeout("initData()","1000");
      	});
      	
      	//监听网络状态功能
      	function netChangeSwitch() {
      		document.addEventListener("netchange",function(){
      			//判断网络的状态
						var connectionStatus = plus.networkinfo.getCurrentType();
						if (connectionStatus != 0 && connectionStatus != 1) {
							//重新打开网络连接
							var headtitle = document.getElementById("headtitle");
							headtitle.innerHTML="小溪";
						}else {
							//关闭网络连接
							var headtitle = document.getElementById("headtitle");
							headtitle.innerHTML="小溪(未连接)";
						}
      		});
      	}
      	
      	function initData() {
      		var xiaoxi_chatlist= plus.webview.getWebviewById("xiaoxi-chatlist.html");
      		mui.fire(xiaoxi_chatlist,"refresh");
      		var xiaoxi_my= plus.webview.getWebviewById("xiaoxi-my.html");
      		mui.fire(xiaoxi_my,"refresh");
      	}
    </script>
</body>
</html>